{"remainingRequest":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\node_modules\\babel-loader\\lib\\index.js!E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\src\\store\\modules\\user.js","dependencies":[{"path":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\src\\store\\modules\\user.js","mtime":1656728727281},{"path":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\babel.config.js","mtime":1656728727231},{"path":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656730876452},{"path":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1656730879893},{"path":"E:\\B-web\\02 第二阶段.听课记录\\06-23skr\\admin-shop\\node_modules\\eslint-loader\\index.js","mtime":1656730877210}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQsIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwoKdmFyIGdldERlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uIGdldERlZmF1bHRTdGF0ZSgpIHsKICByZXR1cm4gewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10gLy8g6K6w5b2V55m75b2V55So5oi355qE6Lqr5Lu9CgogIH07Cn07Cgp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICB9LAogIFNFVF9ST0xFUzogZnVuY3Rpb24gU0VUX1JPTEVTKHN0YXRlLCByb2xlcykgewogICAgc3RhdGUucm9sZXMgPSByb2xlczsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIHVzZXIgbG9naW4KICAvLyBzdG9yZS5kaXNwYXRjaCgndXNlci9sb2dpbicpCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgdXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZSwKICAgICAgICBwYXNzd29yZCA9IHVzZXJJbmZvLnBhc3N3b3JkOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ2luKHsKICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUudHJpbSgpLAogICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIGRhdGEudG9rZW4pOyAvLyB0b2tlbuWtl+autSDnmoTmjIHkuYXljJblrZjlgqjvvIzlrZjlgqjliLBjb29raWVz5LitCgogICAgICAgIHNldFRva2VuKGRhdGEudG9rZW4pOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8v6I635Y+W55So5oi35L+h5oGvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgLy8g6L+U5ZueIHByb21pc2UKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIC8v5ZCR5pyN5Yqh5Zmo5Y+R6K+35rGC77yM6I635Y+W55So5oi35L+h5oGvCiAgICAgIF9nZXRJbmZvKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgICAgaWYgKCFkYXRhKSB7CiAgICAgICAgICByZWplY3QoJ1ZlcmlmaWNhdGlvbiBmYWlsZWQsIHBsZWFzZSBMb2dpbiBhZ2Fpbi4nKTsKICAgICAgICB9IC8vIOacjeWKoeWZqOi/lOWbnuaVsOaNruS4reWMheWQqyByb2xlc++8iOinkuiJsu+8iSxuYW1l77yI55So5oi35ZCN77yJ44CBYXZhdGFyKOWktOWDjynjgIFpbnRyb2R1Y3Rpb24o6Ieq5oiR5LuL57uNKTsKCgogICAgICAgIHZhciByb2xlcyA9IGRhdGEucm9sZXMsCiAgICAgICAgICAgIG5hbWUgPSBkYXRhLm5hbWUsCiAgICAgICAgICAgIGF2YXRhciA9IGRhdGEuYXZhdGFyOyAvLyByb2xlcyBtdXN0IGJlIGEgbm9uLWVtcHR5IGFycmF5CgogICAgICAgIGlmICghcm9sZXMgfHwgcm9sZXMubGVuZ3RoIDw9IDApIHsKICAgICAgICAgIHJlamVjdCgnZ2V0SW5mbzogcm9sZXMgbXVzdCBiZSBhIG5vbi1udWxsIGFycmF5IScpOwogICAgICAgIH0gLy/mm7TmlrBzdG9yZTvlsIbop5LoibLjgIHnlKjmiLflkI3jgIHlpLTlg4/kv53lrZjliLBzdG9yZeS4rQoKCiAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCByb2xlcyk7CiAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIG5hbWUpOwogICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7IC8vIOS/ruaUueW8guatpeS7u+WKoeeahOeKtuaAgeS4unJlc29sdmVkO+S/neWtmOS7u+WKoeeahOe7k+aenOaVsOaNru+8mwoKICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAvLyDkv67mlLnlvILmraXku7vliqHnmoTnirbmgIHkuLpyZWplY3RlZDvkv53lrZjku7vliqHnmoTlpLHotKXljp/lm6DvvJsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gdXNlciBsb2dvdXQKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChfcmVmMykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgICByZXNldFJvdXRlcigpOwogICAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyByZW1vdmUgdG9rZW4KICByZXNldFRva2VuOiBmdW5jdGlvbiByZXNldFRva2VuKF9yZWY0KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","avatar","roles","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","actions","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","console","log","length","resetToken","namespaced"],"sources":["E:/B-web/02 第二阶段.听课记录/06-23skr/admin-shop/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\nimport { resetRouter } from '@/router'\r\n\r\nconst getDefaultState = () => {\r\n  return {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: [],  // 记录登录用户的身份\r\n  }\r\n}\r\n\r\nconst state = getDefaultState()\r\n\r\nconst mutations = {\r\n  RESET_STATE: (state) => {\r\n    Object.assign(state, getDefaultState())\r\n  },\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_NAME: (state, name) => {\r\n    state.name = name\r\n  },\r\n  SET_AVATAR: (state, avatar) => {\r\n    state.avatar = avatar\r\n  },\r\n  SET_ROLES: (state, roles) => {\r\n    state.roles = roles\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  // user login\r\n  // store.dispatch('user/login')\r\n  login({ commit }, userInfo) {\r\n    const { username, password } = userInfo\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password }).then(response => {\r\n        const { data } = response\r\n        commit('SET_TOKEN', data.token)\r\n        // token字段 的持久化存储，存储到cookies中\r\n        setToken(data.token)\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  //获取用户信息\r\n  getInfo({ commit, state }) {\r\n    // 返回 promise\r\n    return new Promise((resolve, reject) => {\r\n      //向服务器发请求，获取用户信息\r\n      getInfo(state.token).then(response => {\r\n        const { data } = response\r\n        console.log(data);\r\n        if (!data) {\r\n          reject('Verification failed, please Login again.')\r\n        }\r\n\r\n        // 服务器返回数据中包含 roles（角色）,name（用户名）、avatar(头像)、introduction(自我介绍);\r\n        const { roles, name, avatar } = data\r\n\r\n        // roles must be a non-empty array\r\n        if (!roles || roles.length <= 0) {\r\n          reject('getInfo: roles must be a non-null array!')\r\n        }\r\n        \r\n        //更新store;将角色、用户名、头像保存到store中\r\n        commit('SET_ROLES', roles)\r\n        commit('SET_NAME', name)\r\n        commit('SET_AVATAR', avatar)\r\n\r\n        // 修改异步任务的状态为resolved;保存任务的结果数据；\r\n        resolve(data)\r\n      }).catch(error => {\r\n         // 修改异步任务的状态为rejected;保存任务的失败原因；\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      logout(state.token).then(() => {\r\n        removeToken() // must remove  token  first\r\n        resetRouter()\r\n        commit('RESET_STATE')\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      removeToken() // must remove  token  first\r\n      commit('RESET_STATE')\r\n      resolve()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions,\r\n \r\n}\r\n\r\n"],"mappings":"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"}]}